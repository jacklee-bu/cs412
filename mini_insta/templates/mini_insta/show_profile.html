{% extends 'mini_insta/base.html' %}

{% block title %}{{ profile.display_name }} - Mini Insta{% endblock %}

{% block content %}
<center>
    <img src="{{ profile.profile_image_url }}" alt="{{ profile.display_name }}"
         width="120" height="120" style="border: 2px solid black;">

    <h1>{{ profile.display_name }}</h1>
    <p><b>@{{ profile.username }}</b></p>
</center>

<hr>

<h3 style="color: green;">About This User:</h3>
<p>
    {% if profile.bio_text %}
        {{ profile.bio_text }}
    {% else %}
        No bio provided.
    {% endif %}
</p>

<table border="1" style="margin-top: 20px; background-color: lightyellow;">
    <tr>
        <td><strong>Username:</strong></td>
        <td>{{ profile.username }}</td>
    </tr>
    <tr>
        <td><strong>Display Name:</strong></td>
        <td>{{ profile.display_name }}</td>
    </tr>
    <tr>
        <td><strong>Member Since:</strong></td>
        <td>{{ profile.join_date|date:"F d, Y" }}</td>
    </tr>
</table>

<br>
<a href="{% url 'mini_insta:update_profile' profile.pk %}"
   style="padding: 5px 15px; background-color: lightblue; text-decoration: none; color: black; border: 1px solid black;">
    Update Profile
</a>

<br>
<hr>
<h3 style="color: green;">Posts</h3>

<div style="display: flex; flex-wrap: wrap; gap: 15px;">
    {% for post in profile.get_all_posts %}
        <div style="border: 1px solid gray; padding: 10px; width: 200px;">
            {% with post.get_all_photos.first as first_photo %}
                {% if first_photo %}
                    <a href="{% url 'mini_insta:post_detail' post.pk %}">
                        <img src="{{ first_photo.get_image_url }}" alt="Post image"
                             style="width: 100%; height: 200px; object-fit: cover;">
                    </a>
                {% else %}
                    <a href="{% url 'mini_insta:post_detail' post.pk %}">
                        <div style="width: 100%; height: 200px; background-color: lightgray;
                                display: flex; align-items: center; justify-content: center;">
                            <p>No Image</p>
                        </div>
                    </a>
                {% endif %}
            {% endwith %}
            <p style="margin-top: 10px;">
                {% if post.caption %}
                    {{ post.caption|truncatewords:10 }}
                {% else %}
                    <i>No caption</i>
                {% endif %}
            </p>
            <small>{{ post.timestamp|date:"M d, Y" }}</small>
        </div>
    {% empty %}
        <p>No posts yet.</p>
    {% endfor %}
</div>

<br>
<p>
    <a href="{% url 'mini_insta:show_all_profiles' %}" style="color: blue; text-decoration: underline;">
        &lt;-- Go Back to All Profiles
    </a>
</p>
{% endblock %}